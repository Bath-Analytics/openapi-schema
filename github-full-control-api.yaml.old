openapi: 3.1.0
info:
  title: GitHub Full Control API for Bath-Analytics/cflow-control-center
  description: |
    Complete, fully expanded OpenAPI 3.1.0 specification for the GitHub REST API, 
    providing comprehensive control over the Bath-Analytics/cflow-control-center repository.
    This specification enables full Custom GPT integration with support for all repository operations
    including security alerts, workflows, deployments, webhooks, team management, and settings.
  version: 2.0.0
  contact:
    name: Bath Analytics
    url: https://github.com/Bath-Analytics
servers:
  - url: https://api.github.com
    description: GitHub REST API v3
components:
  securitySchemes:
    githubToken:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: GitHub Personal Access Token or Fine-grained token with appropriate scopes
  
  schemas:
    Error:
      type: object
      description: Standard error response from GitHub API
      properties:
        message:
          type: string
          description: Error message
        documentation_url:
          type: string
          description: URL to relevant documentation
        status:
          type: string
          description: HTTP status code as string
      required:
        - message
    
    Repository:
      type: object
      description: Repository information
      properties:
        id:
          type: integer
        name:
          type: string
        full_name:
          type: string
        description:
          type: string
          nullable: true
        private:
          type: boolean
        visibility:
          type: string
          enum: [public, private, internal]
        default_branch:
          type: string
        topics:
          type: array
          items:
            type: string
        homepage:
          type: string
          nullable: true
        archived:
          type: boolean
        disabled:
          type: boolean
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
        pushed_at:
          type: string
          format: date-time
        size:
          type: integer
        stargazers_count:
          type: integer
        watchers_count:
          type: integer
        forks_count:
          type: integer
        open_issues_count:
          type: integer
        allow_forking:
          type: boolean
        allow_merge_commit:
          type: boolean
        allow_squash_merge:
          type: boolean
        allow_rebase_merge:
          type: boolean
        allow_auto_merge:
          type: boolean
        delete_branch_on_merge:
          type: boolean
    
    Branch:
      type: object
      description: Git branch
      properties:
        name:
          type: string
        commit:
          type: object
          properties:
            sha:
              type: string
            url:
              type: string
        protected:
          type: boolean
    
    BranchProtection:
      type: object
      description: Branch protection settings
      properties:
        required_status_checks:
          type: object
          nullable: true
          properties:
            strict:
              type: boolean
            contexts:
              type: array
              items:
                type: string
            checks:
              type: array
              items:
                type: object
        enforce_admins:
          type: object
          nullable: true
          properties:
            enabled:
              type: boolean
        required_pull_request_reviews:
          type: object
          nullable: true
          properties:
            dismiss_stale_reviews:
              type: boolean
            require_code_owner_reviews:
              type: boolean
            required_approving_review_count:
              type: integer
        restrictions:
          type: object
          nullable: true
        required_linear_history:
          type: object
          properties:
            enabled:
              type: boolean
        allow_force_pushes:
          type: object
          properties:
            enabled:
              type: boolean
        allow_deletions:
          type: object
          properties:
            enabled:
              type: boolean
    
    Commit:
      type: object
      description: Git commit
      properties:
        sha:
          type: string
        commit:
          type: object
        author:
          type: object
          nullable: true
        committer:
          type: object
          nullable: true
    
    Issue:
      type: object
      description: GitHub issue
      properties:
        id:
          type: integer
        number:
          type: integer
        title:
          type: string
        body:
          type: string
          nullable: true
        state:
          type: string
          enum: [open, closed]
        locked:
          type: boolean
        labels:
          type: array
          items:
            type: object
        assignees:
          type: array
          items:
            type: object
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
    
    PullRequest:
      type: object
      description: Pull request
      properties:
        id:
          type: integer
        number:
          type: integer
        title:
          type: string
        body:
          type: string
          nullable: true
        state:
          type: string
          enum: [open, closed]
        locked:
          type: boolean
        draft:
          type: boolean
        merged:
          type: boolean
        mergeable:
          type: boolean
          nullable: true
        head:
          type: object
        base:
          type: object
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
    
    WorkflowRun:
      type: object
      description: Workflow run
      properties:
        id:
          type: integer
        name:
          type: string
        status:
          type: string
          enum: [queued, in_progress, completed, waiting]
        conclusion:
          type: string
          nullable: true
          enum: [success, failure, neutral, cancelled, skipped, timed_out, action_required]
        workflow_id:
          type: integer
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
    
    Workflow:
      type: object
      description: GitHub Actions workflow
      properties:
        id:
          type: integer
        name:
          type: string
        path:
          type: string
        state:
          type: string
          enum: [active, deleted, disabled_manually, disabled_inactivity]
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
    
    DependabotAlert:
      type: object
      description: Dependabot security alert
      properties:
        number:
          type: integer
        state:
          type: string
          enum: [auto_dismissed, dismissed, fixed, open]
        dependency:
          type: object
        security_advisory:
          type: object
        security_vulnerability:
          type: object
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
    
    CodeScanningAlert:
      type: object
      description: Code scanning alert
      properties:
        number:
          type: integer
        state:
          type: string
          enum: [open, dismissed, fixed]
        dismissed_reason:
          type: string
          nullable: true
        rule:
          type: object
        tool:
          type: object
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
    
    SecretScanningAlert:
      type: object
      description: Secret scanning alert
      properties:
        number:
          type: integer
        state:
          type: string
          enum: [open, resolved]
        resolution:
          type: string
          nullable: true
          enum: [false_positive, wont_fix, revoked, used_in_tests]
        secret_type:
          type: string
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
    
    Webhook:
      type: object
      description: Repository webhook
      properties:
        id:
          type: integer
        name:
          type: string
        active:
          type: boolean
        events:
          type: array
          items:
            type: string
        config:
          type: object
          properties:
            url:
              type: string
            content_type:
              type: string
            secret:
              type: string
            insecure_ssl:
              type: string
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
    
    Deployment:
      type: object
      description: Deployment
      properties:
        id:
          type: integer
        ref:
          type: string
        task:
          type: string
        environment:
          type: string
        description:
          type: string
          nullable: true
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
    
    DeploymentStatus:
      type: object
      description: Deployment status
      properties:
        id:
          type: integer
        state:
          type: string
          enum: [error, failure, inactive, in_progress, queued, pending, success]
        description:
          type: string
          nullable: true
        environment:
          type: string
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
    
    Collaborator:
      type: object
      description: Repository collaborator
      properties:
        login:
          type: string
        id:
          type: integer
        permissions:
          type: object
          properties:
            pull:
              type: boolean
            push:
              type: boolean
            admin:
              type: boolean
            maintain:
              type: boolean
            triage:
              type: boolean
        role_name:
          type: string
          enum: [read, triage, write, maintain, admin]
    
    Team:
      type: object
      description: Organization team
      properties:
        id:
          type: integer
        name:
          type: string
        slug:
          type: string
        description:
          type: string
          nullable: true
        privacy:
          type: string
          enum: [secret, closed]
        permission:
          type: string
          enum: [pull, push, admin, maintain, triage]
    
    Release:
      type: object
      description: Repository release
      properties:
        id:
          type: integer
        tag_name:
          type: string
        name:
          type: string
          nullable: true
        body:
          type: string
          nullable: true
        draft:
          type: boolean
        prerelease:
          type: boolean
        created_at:
          type: string
          format: date-time
        published_at:
          type: string
          format: date-time
          nullable: true
    
    Tag:
      type: object
      description: Git tag
      properties:
        name:
          type: string
        commit:
          type: object
          properties:
            sha:
              type: string
            url:
              type: string
        zipball_url:
          type: string
        tarball_url:
          type: string

security:
  - githubToken: []
paths:
  # ============================================================================
  # REPOSITORY ENDPOINTS
  # ============================================================================
  
  /repos/Bath-Analytics/cflow-control-center:
    get:
      operationId: getRepository
      summary: Get repository information
      description: Returns detailed information about the repository including settings, statistics, and metadata
      responses:
        '200':
          description: Repository information retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Repository'
        '404':
          description: Repository not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
    
    patch:
      operationId: updateRepository
      summary: Update repository settings
      description: Update repository properties including name, description, homepage, visibility, default branch, and more
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                  description: Repository name
                description:
                  type: string
                  description: Repository description
                homepage:
                  type: string
                  description: Repository homepage URL
                private:
                  type: boolean
                  description: Whether the repository is private
                visibility:
                  type: string
                  enum: [public, private, internal]
                  description: Repository visibility
                has_issues:
                  type: boolean
                has_projects:
                  type: boolean
                has_wiki:
                  type: boolean
                is_template:
                  type: boolean
                default_branch:
                  type: string
                  description: Update the default branch name
                allow_squash_merge:
                  type: boolean
                allow_merge_commit:
                  type: boolean
                allow_rebase_merge:
                  type: boolean
                allow_auto_merge:
                  type: boolean
                delete_branch_on_merge:
                  type: boolean
                archived:
                  type: boolean
                  description: Archive or unarchive the repository
      responses:
        '200':
          description: Repository updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Repository'
        '404':
          description: Repository not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /repos/Bath-Analytics/cflow-control-center/commits:
    get:
      operationId: listCommits
      summary: List commits
      parameters:
        - in: query
          name: sha
          schema:
            type: string
            example: main
        - in: query
          name: per_page
          schema:
            type: integer
            default: 5
      responses:
        '200':
          description: Commits
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GenericResponse'

  /repos/Bath-Analytics/cflow-control-center/branches:
    get:
      operationId: listBranches
      summary: List all branches
      responses:
        '200':
          description: Branches
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GenericResponse'

  /repos/Bath-Analytics/cflow-control-center/releases:
    get:
      operationId: listReleases
      summary: List releases
      responses:
        '200':
          description: Releases
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GenericResponse'

  /repos/Bath-Analytics/cflow-control-center/tags:
    get:
      operationId: listTags
      summary: List tags
      responses:
        '200':
          description: Tags
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GenericResponse'

  /repos/Bath-Analytics/cflow-control-center/deployments:
    get:
      operationId: listDeployments
      summary: List deployments made through GitHub
      responses:
        '200':
          description: Deployments
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GenericResponse'

  /repos/Bath-Analytics/cflow-control-center/issues:
    get:
      operationId: listIssues
      summary: List issues
      parameters:
        - in: query
          name: state
          schema:
            type: string
            enum: [open, closed, all]
            default: open
      responses:
        '200':
          description: Issues
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GenericResponse'

  /repos/Bath-Analytics/cflow-control-center/pulls:
    get:
      operationId: listPullRequests
      summary: List pull requests
      parameters:
        - in: query
          name: state
          schema:
            type: string
            enum: [open, closed, all]
            default: open
      responses:
        '200':
          description: PRs
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GenericResponse'

  /repos/Bath-Analytics/cflow-control-center/actions/runs:
    get:
      operationId: listWorkflowRuns
      summary: List workflow runs
      parameters:
        - in: query
          name: per_page
          schema:
            type: integer
            default: 5
      responses:
        '200':
          description: Workflow runs
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GenericResponse'

  /repos/Bath-Analytics/cflow-control-center/actions/runs/{run_id}/jobs:
    get:
      operationId: listWorkflowJobs
      summary: List jobs in a workflow run
      parameters:
        - in: path
          name: run_id
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Workflow jobs
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GenericResponse'

  /repos/Bath-Analytics/cflow-control-center/actions/jobs/{job_id}/logs:
    get:
      operationId: getJobLogs
      summary: Get job logs
      parameters:
        - in: path
          name: job_id
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Job logs
          content:
            text/plain:
              schema:
                type: string

  /repos/Bath-Analytics/cflow-control-center/contents/{path}:
    get:
      operationId: getFileContents
      summary: Get contents of a file
      parameters:
        - in: path
          name: path
          required: true
          schema:
            type: string
            example: README.md
        - in: query
          name: ref
          schema:
            type: string
            example: main
      responses:
        '200':
          description: File contents
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GenericResponse'

  /repos/Bath-Analytics/cflow-control-center/commits/{ref}/status:
    get:
      operationId: getCommitStatus
      summary: Get status checks for a commit
      parameters:
        - in: path
          name: ref
          required: true
          schema:
            type: string
            example: main
      responses:
        '200':
          description: Status checks
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GenericResponse'

  /repos/Bath-Analytics/cflow-control-center/stats/contributors:
    get:
      operationId: getContributors
      summary: List contributors with commit stats
      responses:
        '200':
          description: Contributors
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GenericResponse'

  /repos/Bath-Analytics/cflow-control-center/hooks:
    get:
      operationId: listWebhooks
      summary: List webhooks configured on the repo
      responses:
        '200':
          description: Webhooks
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GenericResponse'

  /repos/Bath-Analytics/cflow-control-center/branches/{branch}:
    get:
      operationId: getBranch
      summary: Get branch info
      parameters:
        - in: path
          name: branch
          required: true
          schema:
            type: string
            example: main
      responses:
        '200':
          description: Branch info
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GenericResponse'

  /repos/Bath-Analytics/cflow-control-center/actions/workflows:
    get:
      operationId: listWorkflows
      summary: List all workflows in the repo
      responses:
        '200':
          description: Workflow metadata
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GenericResponse'

  /repos/Bath-Analytics/cflow-control-center/actions/workflows/{workflow_id}/disable:
    put:
      operationId: disableWorkflow
      summary: Disable a workflow
      parameters:
        - in: path
          name: workflow_id
          required: true
          schema:
            type: integer
      responses:
        '204':
          description: Workflow disabled

  /repos/Bath-Analytics/cflow-control-center/actions/workflows/{workflow_id}/enable:
    put:
      operationId: enableWorkflow
      summary: Enable a workflow
      parameters:
        - in: path
          name: workflow_id
          required: true
          schema:
            type: integer
      responses:
        '204':
          description: Workflow enabled

  /repos/Bath-Analytics/cflow-control-center/pulls/comments:
    get:
      operationId: listPRComments
      summary: List all pull request review comments
      responses:
        '200':
          description: PR comments
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GenericResponse'

  /repos/Bath-Analytics/cflow-control-center/pulls/{pull_number}/reviews:
    get:
      operationId: listPRReviews
      summary: List reviews for a specific pull request
      parameters:
        - in: path
          name: pull_number
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Pull request reviews
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GenericResponse'

  /repos/Bath-Analytics/cflow-control-center/branches/{branch}/protection:
    get:
      operationId: getBranchProtection
      summary: Get branch protection rules
      parameters:
        - in: path
          name: branch
          required: true
          schema:
            type: string
            example: main
      responses:
        '200':
          description: Protection rules
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GenericResponse'

  /repos/Bath-Analytics/cflow-control-center/community/profile:
    get:
      operationId: getCommunityProfile
      summary: Get community standards health file status
      responses:
        '200':
          description: Community profile
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GenericResponse'

  /repos/Bath-Analytics/cflow-control-center/license:
    get:
      operationId: getRepoLicense
      summary: Get the repo license
      responses:
        '200':
          description: License info
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GenericResponse'

  /repos/Bath-Analytics/cflow-control-center/readme:
    get:
      operationId: getRepoReadme
      summary: Get the repo README content
      responses:
        '200':
          description: README file
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GenericResponse'

  /repos/Bath-Analytics/cflow-control-center/traffic/views:
    get:
      operationId: getTrafficViews
      summary: Get traffic view stats
      responses:
        '200':
          description: Traffic views
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GenericResponse'

  /repos/Bath-Analytics/cflow-control-center/traffic/clones:
    get:
      operationId: getTrafficClones
      summary: Get traffic clone stats
      responses:
        '200':
          description: Traffic clones
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GenericResponse'

  /repos/Bath-Analytics/cflow-control-center/collaborators:
    get:
      operationId: listCollaborators
      summary: List collaborators on the repo
      responses:
        '200':
          description: Collaborators
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GenericResponse'

  /repos/Bath-Analytics/cflow-control-center/git/refs:
    post:
      operationId: createBranch
      summary: Create a new branch (ref)
      requestBody:
        required: true
        content:
          application/json:
            schema:
              required: [ref, sha]
              type: object
              properties:
                ref:
                  type: string
                  example: refs/heads/new-feature
                sha:
                  type: string
                  example: base commit SHA
      responses:
        '201':
          description: Branch created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GenericResponse'

  /repos/Bath-Analytics/cflow-control-center/git/refs/heads/{branch}:
    delete:
      operationId: deleteBranch
      summary: Delete a branch
      parameters:
        - in: path
          name: branch
          required: true
          schema:
            type: string
      responses:
        '204':
          description: Branch deleted

    patch:
      operationId: updateBranch
      summary: Force move branch to a different commit
      parameters:
        - in: path
          name: branch
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [sha]
              properties:
                sha:
                  type: string
                force:
                  type: boolean
      responses:
        '200':
          description: Branch updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GenericResponse'

  /repos/Bath-Analytics/cflow-control-center/branches/{branch}/protection:
    put:
      operationId: protectBranch
      summary: Protect a branch
      parameters:
        - in: path
          name: branch
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [required_status_checks]
              properties:
                required_status_checks:
                  type: object
                  properties:
                    strict:
                      type: boolean
                    contexts:
                      type: array
                      items:
                        type: string
      responses:
        '200':
          description: Branch protected
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GenericResponse'

  /repos/Bath-Analytics/cflow-control-center/pulls/{pull_number}/merge:
    put:
      operationId: mergePullRequest
      summary: Merge a pull request
      parameters:
        - in: path
          name: pull_number
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: PR merged
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GenericResponse'

  /repos/Bath-Analytics/cflow-control-center/issues:
    post:
      operationId: createIssue
      summary: Create a new issue
      requestBody:
        required: true
        content:
          application/json:
            schema:
              required: [title]
              type: object
              properties:
                title:
                  type: string
                body:
                  type: string
      responses:
        '201':
          description: Issue created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GenericResponse'

  /repos/Bath-Analytics/cflow-control-center/actions/runs/{run_id}/rerun:
    post:
      operationId: rerunWorkflow
      summary: Rerun a workflow
      parameters:
        - in: path
          name: run_id
          required: true
          schema:
            type: integer
      responses:
        '201':
          description: Workflow rerun started
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GenericResponse'

  /repos/Bath-Analytics/cflow-control-center/actions/secrets:
    get:
      operationId: listActionSecrets
      summary: List GitHub Actions secrets for the repo
      responses:
        '200':
          description: Secrets list
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GenericResponse'

  /rate_limit:
    get:
      operationId: getRateLimit
      summary: Get current GitHub API rate limits
      responses:
        '200':
          description: Rate limit status
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GenericResponse'

  /users/{username}:
    get:
      operationId: getUserInfo
      summary: Get public GitHub profile for a user
      parameters:
        - in: path
          name: username
          required: true
          schema:
            type: string
      responses:
        '200':
          description: User info
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GenericResponse'

